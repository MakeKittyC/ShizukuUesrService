#include <signal.h>
#include <unistd.h>
#include <jni.h>
#include <string>

extern "C" JNIEXPORT void JNICALL
Java_app_compile_SuiApplication_terminateProcess(JNIEnv *env, jobject) {
    pid_t pid = getpid();
    kill(pid, SIGKILL);
}

const int XP_CONSTANT = 7040;

extern "C" JNIEXPORT jint JNICALL
Java_app_compile_SuiApplication_getXpConstant(JNIEnv *env, jobject) {
    return XP_CONSTANT;
}

const char* XP_STRING_CONSTANT = "360952409";

extern "C" JNIEXPORT jstring JNICALL
Java_app_compile_SuiApplication_getXpStringConstant(JNIEnv *env, jobject) {
    return env->NewStringUTF(XP_STRING_CONSTANT);
}

const char* XPS_STRING_CONSTANT = "30820880308204f8a00302010202041583b259300d06092a864886f70d01010c05003069310f300d06035504060c06e596b5e5919c310f300d06035504080c06e596b5e5919c310f300d06035504070c06e596b5e5919c310f300d060355040a0c06e5b08fe78cab310f300d060355040b0c06e596b5e5919c3112301006035504030c09e5b08fe596b5e596b53020170d3235303431313135303331345a180f33303233303831333135303331345a3069310f300d06035504060c06e596b5e5919c310f300d06035504080c06e596b5e5919c310f300d06035504070c06e596b5e5919c310f300d060355040a0c06e5b08fe78cab310f300d060355040b0c06e596b5e5919c3112301006035504030c09e5b08fe596b5e596b530820392300d06092a864886f70d01010105000382037f003082037a0282037100b25c039c2067dc9cfca942f2d421a5d713757c8567cc4e33a81b2ed750006637a1cc66035244d6d8bc6d2f15e7c2fb0b2edefd9eb4cc7fcba97d3aeb792a345c2d84c6bea6a4f7874e89e685336b1f0cf5a2d1b7886dda9e5c9e3c75eec79c721280157c31ccfd09117f16dc03bf7d9595a42f0b13fdc0d9224836e07d9eba0a896c1e2bd566410eb3c21b097ea68045915c0f6434776b38e31118fabddd5215fd53c50e0c7b24a955e0c521ec6161fa07a0a8c186c5c37f2f2a3e5d80939cc22c36db8eb205e4ca8260fe3e5ffd0a0c2a5773e219075f47872f3edb5d6f836f7d41999f5d0a9419ac375f446fd5ac48b137c69ad83ef0c343402b0261b73a1a43516a61fc3b4af59f200132e2b31d38bba6f83c81a1d979cea4cba5c4c23ce6858d524bb2cc0ab1cfb0bbb10b779d35ad69abad1e071d7dd0cd12cb8b9b269983860f1df50146340970abbf2dff36e452695055536e70bfe7724c56283f7a2603e854c01b260b92196fe95e1f5dafa0562b31b416bcaf68c2306920b40a966fed71cd7ccec76c2d17b6f60a3d7c95e03443350655f9c3b763c986c916c80ec587ef81e539323d605940cf1a0e8c49ccb23e83f3019a34ec926b6ec8b9a4335704a85066012c21cec173c9a3271ec74460075222f22e1227c5fe5fe78b312aceeae113772ac906140428e3a1c11c724cd7f69a4ec1fe871d12ff3ea532e86a0ae0b43dcdffc4622f927ca9c95609e116b66191b699bf7d9634f05e76a5e2ec921c80282f0cb86f50efc8c6fd12dfc40eec15440ed1425d72608f68a21ae9c296642012b2cccd0b9e42d66f1145da26f42a774d91d2e5c7fc1faea21e3f7a120fdca766d9e4111d8944dbb245880086f9f4398921a79ca7e2e3d9bf5c723bbe2e508ff0748c57754df7f341dc9a9d3cb2ebc4103d9a57b9d8879125fdd79ea3cedb698c76ee91f4652b7b3b5e8a8c54bd18bc19c71193b4e23c12368708c55cd56c4cae83879256cccf296476174ab99fe9550d5d27208aa4e594d7e18340428922579dceb458343d3227c8020898e354d50f9ffb981c6bfff45c5d09e99f4720e8cd35e4858f9c72be27b1f23f6a323b877267f56da1dad992111f8d5be7a00a5d851b75b1a3d91680266d75941e141d65d62cbc8a89f4b4e0d59d9c69bc85d29e45f677bb368bbbcc9bb6f7f7b063fb705452a65e34230114d3ea5ca8030b6380b0b069c22bfdbf1de04616a620c6dd0203010001a34e304c302b0603551d1004243022800f32303235303431313135303331345a810f33303233303831333135303331345a301d0603551d0e041604143305e049d571bccaaf36bd1ba290e500ccb1702b300d06092a864886f70d01010c05000382037100391b2ee799bccd436ebc3d3a168d95bf80964d356abcaa8913039a4fe4bbbfef3f588cb258172633688aa1e3727b8faddb328401068604a35d03b7804cf8f7f26f0f5f52129f4d7d7e298395ac9d4bc7b93248247a03f2a24a54b969cbcefdf5cb48b7673413353dc0616fe07ef30dca315a1e90f3c570d4e73d78531284ff785ed8f20152864bc2a0b4a072ca49f409d78f915d26b2afa64c4b0a8546827507cddb3d73356bef3e8cffa95fd15a22950b6fdb8a33aff49fbece1ed221aa1f4601e704bb5acc46f61569e58a8f0baa9eedb832ed41271eb655c9be43761d207090a6e6b76495987c0793616230461af1c787a41fe6193b06f7d1e8f5e54a1af0d1be1ef7e13b6daea13394848a8f17676b6b248eaf49a3b81e5e0522dafe17674b2b776181a11ae5290091e0f1a6b7f1feacf35a3f3f4bf87ebab15d9553c5861ae452a7c1c6507ea380af360854502cdc420f998282fc6339ed4801acdf23ceb8a26b987b695230162d37b6e458ffd7d732c6e96632cbacc452a7ca68477c6dfc20f4d0a0d6092aca3509dbf3d03f9d83996206c3e8eb4cbc475d7dd8a0d0b3270f5397a8d0303b6a02da73aec35cd4104d2c4c22597f1ca5471f15fda28335287f3149a28aa7843cc9e82c8f45b3e8689b73e56e8da9e36bd2e366e0df4afc67ec3e20dc64e1be55713428de917a98487cadff260f935ab8afb9772c3b836fbc6b3f18e9482afb39ef220480f362f556175f117669eec3f521172496c7d790a9495b46c5b532aa22cd4ea7b8a45ab5c94015bc7e43ab0d1a01bba99f90a839c373f899bbec1d1e602e8580167678d6dada94c0345f4fb1ef50bcfcfc15f94b1ef3902f136f153a02fbbd64935af7ce046ccc9d086b1e004dd4b052e5d17acef149d2af435ff7ca086b84353a8495b17d6987f449a6de7d19c08a408472413740b30eaa243c9b770e56a45c9ecfc8904aadcb137d589a72743c82ec2366e45948e9209cad30e31da7166de5d7fd50ebfe316862231828db03fe7d9d7b3a56bbaacd482f2bb4699885d7693481428d57b2bd276208d338c6974ba89bc69976417182a1c2eaa6a16f1743f269f63611bdc875c661685f3b94c92b60be6b6a0cbeb990ed35aab38fb2eaa67eb80fd38f88054f863786bec697dda8a5ac165473e53ab49d535040d3b7bb0d0c928dbd16f39af5903e34e3ee01b6b53ceccc1403d4acefebe2e5c419fc250041eb7d4526a6";

extern "C" JNIEXPORT jstring JNICALL
Java_app_compile_SuiApplication_getXpsStringConstant(JNIEnv *env, jobject) {
    return env->NewStringUTF(XPS_STRING_CONSTANT);
}

const char* SYSTEM_BIN_PATH = "/system/bin/";

extern "C" JNIEXPORT jstring JNICALL
Java_app_compile_MainActivity_getSystemBinPath(JNIEnv *env, jobject) {
    return env->NewStringUTF(SYSTEM_BIN_PATH);
}

const char* PRIVATE_BIN_PATH = "/sdcard/Android/data/adb.shell.shizuku/files/shizuku/";

extern "C" JNIEXPORT jstring JNICALL
Java_app_compile_MainActivity_getPrivateBinPath(JNIEnv *env, jobject) {
    return env->NewStringUTF(PRIVATE_BIN_PATH);
}

const char* KSU_BIN_PATH = "/data/adb/ksu/bin/";

extern "C" JNIEXPORT jstring JNICALL
Java_app_compile_MainActivity_getKsuBinPath(JNIEnv *env, jobject) {
    return env->NewStringUTF(KSU_BIN_PATH);
}

const char* VENDOR_BIN_PATH = "/vendor/bin/";

extern "C" JNIEXPORT jstring JNICALL
Java_app_compile_MainActivity_getVendorBinPath(JNIEnv *env, jobject) {
    return env->NewStringUTF(VENDOR_BIN_PATH);
}

const char* SYSTEMS_BIN_PATH = "/system_ext/bin/";

extern "C" JNIEXPORT jstring JNICALL
Java_app_compile_MainActivity_getSystemsBinPath(JNIEnv *env, jobject) {
    return env->NewStringUTF(SYSTEMS_BIN_PATH);
}